<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>劇照浮水印編輯器 - GagaOOLala</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <link rel="manifest" href="favicon/site.webmanifest">

    <!-- 1. JSZip & FileSaver -->
    <script src="js/vendor/jszip.min.js"></script>
    <script src="js/vendor/FileSaver.min.js"></script>

    <!-- 2. SmartCrop (備援引擎) -->
    <script src="js/vendor/smartcrop.min.js"></script>

    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <!-- 側邊欄 -->
    <div class="sidebar">
        <div>
            <h1>劇照編輯器</h1>
            <div class="subtitle">V8.0</div>

            <div class="control-group">
                <label>使用情境</label>
                <div class="engine-switch">
                    <button id="btnUsageSocial" class="engine-btn active">社交平台 <span class="engine-desc">IG/FB
                            (橫+直)</span></button>
                    <button id="btnUsageOfficial" class="engine-btn">官網專用 <span class="engine-desc">僅橫式
                            (1920)</span></button>
                </div>
            </div>

            <div id="modeIndicator" class="mode-indicator active-landscape">目前設定模式：橫式 (Landscape)</div>

            <div class="control-group">
                <label style="color:white;">📁 專案命名 (影集名 + 集數)</label>
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="seriesName" list="seriesList" placeholder="影集名" style="flex:2;">
                    <datalist id="seriesList"></datalist>
                    <input type="text" id="episodeNumber" placeholder="集數 (例如: 1)" style="flex:1;">
                </div>
            </div>

            <div class="control-group" id="groupLogoUpload">
                <label>1. 上傳 Logo (可多選)</label>
                <div class="logo-controls">
                    <label for="logoInput" class="file-btn" id="logoLabel">選擇 PNG Logo (TW/EN)</label>
                    <div class="lang-switch">
                        <button id="btnLangCN" class="lang-btn active">TW</button>
                        <button id="btnLangEN" class="lang-btn">EN</button>
                    </div>
                </div>
                <input type="file" id="logoInput" accept="image/png, image/jpeg" multiple>
                <div id="logoStatus" style="font-size: 12px; margin-top: 5px; color: #aaa;">
                    <!-- JS will populate this -->
                </div>
            </div>

            <div class="control-group">
                <label>2. 上傳劇照</label>
                <label for="imageInput" class="file-btn">新增圖片</label>
                <input type="file" id="imageInput" multiple accept="image/*">

                <div
                    style="display:flex; justify-content:space-between; margin-top:10px; align-items:center; flex-wrap: wrap; gap: 5px;">
                    <div style="font-size:12px; color:#aaa;">此模式已選: <span id="selectedCount"
                            style="color:var(--accent-color);">0</span> 張</div>
                    <div style="display:flex; gap:5px;">
                        <button id="toggleSelectBtn" class="btn-outline"
                            style="font-size:12px; padding: 4px 8px;">全選</button>
                        <button id="clearAllBtn" class="btn-outline"
                            style="color:#ff6b6b; border-color:#ff6b6b; font-size:12px; padding: 4px 8px;">全刪</button>
                    </div>
                </div>
            </div>

            <div class="control-group">
                <label>版權文字</label>
                <input type="text" id="copyrightText"
                    placeholder="例如：©2025 Love Begins in the World of If Production committee・MBS">

                <div class="slider-row" style="margin-top:10px;">
                    <label>文字大小 (<span id="textModeLabel" style="color:var(--accent-color)">橫式</span>)</label>
                    <span class="slider-val" id="fontSizeVal">1.0</span>
                </div>
                <input type="range" id="fontSizeScale" min="0.5" max="3.0" step="0.1" value="1.0">
            </div>

            <!-- Official Mode Only: Individual Text Settings -->
            <div class="control-group" id="officialTextControls" style="display: none;">
                <label>單張調整 (點擊圖片選取)</label>
                <div class="sidebar-controls-row">
                    <div class="sidebar-control-item">
                        <span>文字顏色</span>
                        <div class="color-picker-wrapper">
                            <input type="color" id="itemTextColor" value="#ffffff">
                        </div>
                    </div>
                    <label class="sidebar-control-item checkbox-label" for="itemTextShadow">
                        <input type="checkbox" id="itemTextShadow" checked>
                        <span class="custom-checkbox-sidebar"></span>
                        <span>陰影</span>
                    </label>
                </div>
                <!-- Hidden label to show which item is selected -->
                <div id="selectedItemLabel" class="selected-item-label">未選取圖片</div>
            </div>

            <div class="control-group" id="groupLogoSettings">
                <div class="slider-row"><label>Logo 縮放 (<span id="logoModeLabel"
                            style="color:var(--accent-color)">橫式</span>)</label><span class="slider-val"
                        id="logoScaleVal">54%</span></div>
                <input type="range" id="logoScale" min="10" max="100" value="54">

                <div class="slider-row"><label>Logo 底部距離</label><span class="slider-val" id="logoBottomVal">0%</span>
                </div>
                <input type="range" id="logoBottom" min="0" max="20" value="0">
            </div>

            <div class="control-group" id="groupGradientSettings">
                <div class="slider-row"><label>黑色漸層高度</label><span class="slider-val" id="gradHeightVal">20%</span>
                </div>
                <input type="range" id="gradHeight" min="0" max="60" value="20">

                <div class="slider-row"><label>漸層濃度</label><span class="slider-val" id="gradOpacityVal">0.6</span></div>
                <input type="range" id="gradOpacity" min="0" max="1" step="0.1" value="0.6">
            </div>
        </div>

        <div class="action-area">
            <button id="dlBtn" class="btn btn-primary" disabled>
                <span>⬇</span> 下載目前模式 (全部)
            </button>
        </div>

        <div class="footer-credit">
            <img src="https://img.gagaoolala.com/assets/v2.1.1/img/ui/logo.png" alt="GagaOOLala Logo" width="120"
                height="26">
            <br>
            GagaOOLala 設計部開發
            <br>
            <br>

        </div>
    </div>

    <!-- 主區域 -->
    <div class="main-area">
        <div class="tabs">
            <div class="tab active" data-mode="landscape">橫式編輯區 (1920 x 1080)</div>
            <div class="tab" data-mode="portrait">直式編輯區 (1080 x 1350)</div>
        </div>

        <div class="editor-container" id="editorContainer">
            <div class="empty-state">
                <h2>尚未載入劇照</h2>
                <p>請從左側上傳圖片，系統將自動偵測人臉與構圖</p>
            </div>
        </div>
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <div id="progressText" style="color:white; margin-top:15px; font-weight:bold;">處理中...</div>
        <div id="progressSub" class="loading-subtitle">正在下載 AI 模型</div>
    </div>

    <script src="js/app.js"></script>
    <button id="mobileMenuBtn" class="mobile-menu-btn">⚙️ 設定</button>
</body>

</html>